<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayStation å¥–æ¯</title>
    <style>
        :root {
            /* æš—è‰²ä¸»é¢˜ */
            --bg-primary: #1a1a1a;
            --bg-secondary: #282828;
            --text-primary: #fff;
            --text-secondary: #aaa;
            --border-color: #444;
            --accent-color: #00b0ff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            --container-bg: rgba(40, 40, 40, 0.95);
            --container-border: rgba(255, 255, 255, 0.1);
            --container-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            --container-inset: rgba(255, 255, 255, 0.1);
            --progress-bg: rgba(40, 40, 40, 0.9);
            --hover-bg: rgba(255, 255, 255, 0.1);
            --gradient-light: rgba(255, 255, 255, 0.05);
            --gradient-dark: rgba(255, 255, 255, 0.02);
            --border-radius: 12px;
            --gap-small: 10px;
            --gap-medium: 16px;
            --gap-large: 24px;
            --gap-xlarge: 32px;
        }

        /* äº®è‰²ä¸»é¢˜ */
        [data-theme="light"] {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --text-primary: #333;
            --text-secondary: #666;
            --border-color: #e0e0e0;
            --accent-color: #1976d2;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --container-bg: rgba(255, 255, 255, 0.95);
            --container-border: rgba(0, 0, 0, 0.1);
            --container-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            --container-inset: rgba(255, 255, 255, 0.8);
            --progress-bg: rgba(255, 255, 255, 0.9);
            --hover-bg: rgba(0, 0, 0, 0.05);
            --gradient-light: rgba(255, 255, 255, 0.3);
            --gradient-dark: rgba(255, 255, 255, 0.1);
        }

        * {
            box-sizing: border-box;
        }

        body {
            background: transparent;
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .trophy-container {
            background: var(--container-bg);
            border: 1px solid var(--container-border);
            border-radius: var(--border-radius);
            padding: 20px 24px;
            min-width: 320px;
            max-width: 800px;
            width: 100%;
            display: flex;
            align-items: center;
            gap: var(--gap-large);
            box-shadow: 
                var(--container-shadow),
                inset 0 1px 0 var(--container-inset);
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        /* å†…éƒ¨å…‰æ³½æ•ˆæœ */
        .trophy-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                var(--gradient-light) 0%, 
                transparent 50%, 
                var(--gradient-dark) 100%);
            border-radius: var(--border-radius);
            pointer-events: none;
        }

        .trophy-container:hover {
            transform: translateY(-4px);
            border-color: var(--container-border);
            filter: brightness(1.05);
        }

        /* æš—è‰²ä¸»é¢˜æ‚¬åœæ•ˆæœ */
        :root .trophy-container:hover {
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        /* äº®è‰²ä¸»é¢˜æ‚¬åœæ•ˆæœ */
        [data-theme="light"] .trophy-container:hover {
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }

        .summary,
        .trophy-details,
        .summary-item,
        .trophy-item {
            position: relative;
            z-index: 2;
        }

        .summary {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex: 1;
            text-align: center;
            gap: var(--gap-medium);
        }

        .summary-item {
            flex: 1;
            min-width: 0;
        }

        .summary-item .number {
            font-size: clamp(28px, 5vw, 36px);
            font-weight: bold;
            color: var(--text-primary);
            line-height: 1.2;
        }

        .summary-item .label {
            font-size: clamp(14px, 3vw, 16px);
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .progress-circle {
            position: relative;
            width: clamp(60px, 12vw, 80px);
            height: clamp(60px, 12vw, 80px);
            border-radius: 50%;
            background: conic-gradient(var(--accent-color) 0% var(--progress, 35%), var(--border-color) var(--progress, 35%) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }

        .progress-circle::before {
            content: "";
            position: absolute;
            width: 80%;
            height: 80%;
            background: var(--progress-bg);
            border-radius: 50%;
        }

        .progress-percentage {
            position: relative;
            font-size: clamp(14px, 3vw, 18px);
            font-weight: bold;
            z-index: 1;
        }

        .trophy-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-left: var(--gap-xlarge);
            border-left: 1px solid var(--border-color);
            flex: 1;
            gap: var(--gap-medium);
            min-width: 0;
        }

        .trophy-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--gap-small);
            flex: 1;
            min-width: 0;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
            position: relative;
        }

        .trophy-item:hover {
            background: var(--hover-bg);
            border: 1px solid var(--container-border);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .trophy-item:active {
            transform: translateY(0);
        }

        .trophy-item img {
            width: clamp(32px, 6vw, 48px);
            height: auto;
            transition: transform 0.2s ease;
            user-select: none;
        }

        /* äº®è‰²ä¸»é¢˜ä¸‹å›¾æ ‡çš„é˜´å½±æ•ˆæœ */
        [data-theme="light"] .trophy-item img {
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .trophy-item:hover img {
            transform: scale(1.1);
        }

        .trophy-item .count {
            font-size: clamp(18px, 4vw, 24px);
            font-weight: bold;
            line-height: 1;
            user-select: none;
        }

        /* äº¤äº’æç¤ºå·²ç§»é™¤ */

        /* ç‚¹å‡»åé¦ˆåŠ¨ç”» */
        @keyframes clickFeedback {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .trophy-item.clicked {
            animation: clickFeedback 0.2s ease;
        }

        /* æ•°å­—å˜åŒ–åŠ¨ç”» */
        @keyframes numberChange {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); color: var(--accent-color); }
            100% { transform: scale(1); }
        }

        .count.changed {
            animation: numberChange 0.3s ease;
        }

        /* æ“ä½œæç¤º */
        .controls-hint {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--container-bg);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            border: 1px solid var(--container-border);
            opacity: 0.8;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .trophy-container {
                flex-direction: column;
                gap: var(--gap-medium);
                padding: 16px 20px;
            }

            .trophy-details {
                border-left: none;
                border-top: 1px solid var(--border-color);
                padding-left: 0;
                padding-top: var(--gap-medium);
                width: 100%;
            }

            .summary {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .trophy-item {
                gap: 6px;
            }
            
            .trophy-details {
                gap: 8px;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .trophy-container {
            animation: fadeIn 0.6s ease-out;
        }

        /* è¿›åº¦åœ†ç¯åŠ¨ç”» */
        @keyframes progressAnimation {
            from {
                background: conic-gradient(var(--accent-color) 0% 0%, var(--border-color) 0% 100%);
            }
        }

        .progress-circle.animated {
            animation: progressAnimation 1s ease-out;
        }

        /* æ‚¬æµ®çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--container-bg);
            border: 1px solid var(--container-border);
            border-radius: var(--border-radius);
            padding: 24px;
            min-width: 400px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--container-shadow);
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
            position: relative;
        }

        .modal-overlay.show .modal {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--text-primary);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
            line-height: 1;
        }

        .modal-close:hover {
            color: var(--text-primary);
            background: var(--hover-bg);
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .trophy-input-group {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        .trophy-input-group:hover {
            border-color: var(--accent-color);
            background: var(--hover-bg);
        }

        .trophy-input-icon {
            width: 32px;
            height: 32px;
            flex-shrink: 0;
        }

        .trophy-input-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .trophy-input-label {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 14px;
        }

        .trophy-input-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .trophy-input-fields {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .input-field {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex: 1;
        }

        .input-field label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .input-field input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s ease;
            text-align: center;
            min-width: 60px;
        }

        .input-field input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(0, 176, 255, 0.2);
        }

        .input-field input:invalid {
            border-color: #f44336;
        }

        .summary-section {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 16px;
            border: 1px solid var(--border-color);
        }

        .summary-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .summary-item-modal {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--container-bg);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .summary-item-modal .label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .summary-item-modal .value {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 16px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .btn {
            padding: 10px 20px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn:hover {
            background: var(--hover-bg);
            border-color: var(--accent-color);
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .btn-primary:hover {
            background: rgba(0, 176, 255, 0.8);
        }

        .help-text {
            font-size: 12px;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 16px;
            padding: 8px;
            background: var(--bg-secondary);
            border-radius: 6px;
        }

        /* åˆ†æ•°è¯¦æƒ…æ ·å¼ */
        .score-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 12px;
            background: var(--container-bg);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .score-trophy {
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
        }

        .score-formula {
            color: var(--text-secondary);
            font-size: 13px;
            font-family: 'Courier New', monospace;
        }

        .score-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--accent-color);
            color: white;
            border-radius: 6px;
            margin-top: 4px;
            font-weight: 600;
        }

        .score-label {
            font-size: 14px;
        }

        .score-value {
            font-size: 14px;
            font-family: 'Courier New', monospace;
        }

        /* å“åº”å¼æ‚¬æµ®çª— */
        @media (max-width: 768px) {
            .modal {
                min-width: 320px;
                margin: 20px;
            }
            
            .trophy-input-group {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            
            .trophy-input-info {
                text-align: center;
            }
            
            .trophy-input-fields {
                justify-content: center;
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-actions {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>

    <div class="trophy-container">
        <div class="summary">
            <div class="summary-item">
                <div class="number" id="total-earned">17</div>
                <div class="label">å·²è·å¾—</div>
            </div>
            <div class="summary-item">
                <div class="progress-circle" id="progress-circle">
                    <div class="progress-percentage" id="progress-percentage">35%</div>
                </div>
            </div>
            <div class="summary-item">
                <div class="number" id="total-available">63</div>
                <div class="label">å¯è·å¾—</div>
            </div>
        </div>
        <div class="trophy-details">
            <div class="trophy-item">
                <img src="ç™½é‡‘.png" alt="ç™½é‡‘å¥–æ¯" loading="lazy">
                <div class="count" data-trophy="platinum">0</div>
            </div>
            <div class="trophy-item">
                <img src="é‡‘.png" alt="é‡‘å¥–æ¯" loading="lazy">
                <div class="count" data-trophy="gold">0</div>
            </div>
            <div class="trophy-item">
                <img src="é“¶.png" alt="é“¶å¥–æ¯" loading="lazy">
                <div class="count" data-trophy="silver">0</div>
            </div>
            <div class="trophy-item">
                <img src="é“œ.png" alt="é“œå¥–æ¯" loading="lazy">
                <div class="count" data-trophy="bronze">37</div>
            </div>
        </div>
    </div>

    <!-- æ‚¬æµ®çª— -->
    <div class="modal-overlay" id="trophy-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">å¥–æ¯æ•°æ®è®¾ç½®</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-content">
                <!-- ç™½é‡‘å¥–æ¯ -->
                <div class="trophy-input-group">
                    <img src="ç™½é‡‘.png" alt="ç™½é‡‘å¥–æ¯" class="trophy-input-icon">
                    <div class="trophy-input-info">
                        <div class="trophy-input-label">ç™½é‡‘å¥–æ¯</div>
                        <div class="trophy-input-subtitle">æœ€ç¨€æœ‰çš„å¥–æ¯ç±»å‹</div>
                    </div>
                    <div class="trophy-input-fields">
                        <div class="input-field">
                            <label>å·²è·å¾—</label>
                            <input type="number" id="platinum-earned" min="0" value="0">
                        </div>
                        <div class="input-field">
                            <label>å¯è·å¾—</label>
                            <input type="number" id="platinum-available" min="0" value="1">
                        </div>
                    </div>
                </div>

                <!-- é‡‘å¥–æ¯ -->
                <div class="trophy-input-group">
                    <img src="é‡‘.png" alt="é‡‘å¥–æ¯" class="trophy-input-icon">
                    <div class="trophy-input-info">
                        <div class="trophy-input-label">é‡‘å¥–æ¯</div>
                        <div class="trophy-input-subtitle">ç¨€æœ‰çš„å¥–æ¯ç±»å‹</div>
                    </div>
                    <div class="trophy-input-fields">
                        <div class="input-field">
                            <label>å·²è·å¾—</label>
                            <input type="number" id="gold-earned" min="0" value="0">
                        </div>
                        <div class="input-field">
                            <label>å¯è·å¾—</label>
                            <input type="number" id="gold-available" min="0" value="5">
                        </div>
                    </div>
                </div>

                <!-- é“¶å¥–æ¯ -->
                <div class="trophy-input-group">
                    <img src="é“¶.png" alt="é“¶å¥–æ¯" class="trophy-input-icon">
                    <div class="trophy-input-info">
                        <div class="trophy-input-label">é“¶å¥–æ¯</div>
                        <div class="trophy-input-subtitle">æ™®é€šçš„å¥–æ¯ç±»å‹</div>
                    </div>
                    <div class="trophy-input-fields">
                        <div class="input-field">
                            <label>å·²è·å¾—</label>
                            <input type="number" id="silver-earned" min="0" value="0">
                        </div>
                        <div class="input-field">
                            <label>å¯è·å¾—</label>
                            <input type="number" id="silver-available" min="0" value="20">
                        </div>
                    </div>
                </div>

                <!-- é“œå¥–æ¯ -->
                <div class="trophy-input-group">
                    <img src="é“œ.png" alt="é“œå¥–æ¯" class="trophy-input-icon">
                    <div class="trophy-input-info">
                        <div class="trophy-input-label">é“œå¥–æ¯</div>
                        <div class="trophy-input-subtitle">æœ€å¸¸è§çš„å¥–æ¯ç±»å‹</div>
                    </div>
                    <div class="trophy-input-fields">
                        <div class="input-field">
                            <label>å·²è·å¾—</label>
                            <input type="number" id="bronze-earned" min="0" value="17">
                        </div>
                        <div class="input-field">
                            <label>å¯è·å¾—</label>
                            <input type="number" id="bronze-available" min="0" value="37">
                        </div>
                    </div>
                </div>

                <!-- ç»Ÿè®¡æ‘˜è¦ -->
                <div class="summary-section">
                    <div class="summary-title">ç»Ÿè®¡æ‘˜è¦</div>
                    <div class="summary-grid">
                        <div class="summary-item-modal">
                            <span class="label">æ€»å·²è·å¾—</span>
                            <span class="value" id="modal-total-earned">17</span>
                        </div>
                        <div class="summary-item-modal">
                            <span class="label">æ€»å¯è·å¾—</span>
                            <span class="value" id="modal-total-available">63</span>
                        </div>
                        <div class="summary-item-modal">
                            <span class="label">å®Œæˆåº¦</span>
                            <span class="value" id="modal-completion">27%</span>
                        </div>
                        <div class="summary-item-modal">
                            <span class="label">å‰©ä½™å¥–æ¯</span>
                            <span class="value" id="modal-remaining">46</span>
                        </div>
                    </div>
                </div>

                <!-- åˆ†æ•°è¯¦æƒ… -->
                <div class="summary-section">
                    <div class="summary-title">ğŸ† PlayStation åŠ æƒè®¡åˆ†</div>
                    <div class="score-details">
                        <div class="score-item">
                            <span class="score-trophy">ç™½é‡‘å¥–æ¯</span>
                            <span class="score-formula" id="platinum-score-formula">0 Ã— 300åˆ† = 0åˆ†</span>
                        </div>
                        <div class="score-item">
                            <span class="score-trophy">é‡‘å¥–æ¯</span>
                            <span class="score-formula" id="gold-score-formula">0 Ã— 90åˆ† = 0åˆ†</span>
                        </div>
                        <div class="score-item">
                            <span class="score-trophy">é“¶å¥–æ¯</span>
                            <span class="score-formula" id="silver-score-formula">0 Ã— 30åˆ† = 0åˆ†</span>
                        </div>
                        <div class="score-item">
                            <span class="score-trophy">é“œå¥–æ¯</span>
                            <span class="score-formula" id="bronze-score-formula">17 Ã— 15åˆ† = 255åˆ†</span>
                        </div>
                        <div class="score-total">
                            <span class="score-label">æ€»åˆ†æ•°ï¼š</span>
                            <span class="score-value" id="total-score-display">255 / 945åˆ†</span>
                        </div>
                    </div>
                </div>

                <div class="help-text">
                    å¿«æ·é”®ï¼šæŒ‰ F é”®æ‰“å¼€/å…³é—­æ­¤çª—å£ | Ctrl+S ä¿å­˜æ•°æ® | ESC å…³é—­çª—å£<br>
                    <strong>PlayStation åŠ æƒè®¡åˆ†ï¼š</strong>é“œ15åˆ† | é“¶30åˆ† | é‡‘90åˆ† | ç™½é‡‘300åˆ†
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn" id="modal-cancel">å–æ¶ˆ</button>
                <button class="btn" id="modal-reset">é‡ç½®</button>
                <button class="btn btn-primary" id="modal-save">ä¿å­˜å¹¶åº”ç”¨</button>
            </div>
        </div>
    </div>



    <script>
        // é…ç½®æ–‡ä»¶ç®¡ç†ç±»
        class ConfigManager {
            constructor() {
                this.configPath = './config.json';
                this.defaultConfig = {
                    gameInfo: {
                        name: "PlayStation æ¸¸æˆ",
                        platform: "PS5",
                        lastUpdated: new Date().toISOString().split('T')[0]
                    },
                    trophyData: {
                        totalAvailable: 63,
                        platinum: 0,
                        gold: 0,
                        silver: 0,
                        bronze: 37
                    },
                    settings: {
                        autoSave: true,
                        animationDuration: 800,
                        theme: "dark",
                        language: "zh-CN"
                    },
                    ui: {
                        showPercentage: true,
                        showAnimations: true,
                        compactMode: false
                    }
                };
            }

            // åŠ è½½é…ç½®
            async loadConfig() {
                try {
                    const response = await fetch(this.configPath);
                    if (response.ok) {
                        const config = await response.json();
                        return { ...this.defaultConfig, ...config };
                    }
                } catch (error) {
                    console.warn('æ— æ³•åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:', error);
                }
                return this.defaultConfig;
            }

            // ä¿å­˜é…ç½®åˆ°localStorageï¼ˆæ¨¡æ‹Ÿæ–‡ä»¶ä¿å­˜ï¼‰
            saveConfig(config) {
                try {
                    config.gameInfo.lastUpdated = new Date().toISOString().split('T')[0];
                    localStorage.setItem('trophyConfig', JSON.stringify(config));
                    console.log('é…ç½®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨');
                    return true;
                } catch (error) {
                    console.error('ä¿å­˜é…ç½®å¤±è´¥:', error);
                    return false;
                }
            }

            // ä»localStorageåŠ è½½é…ç½®
            loadLocalConfig() {
                try {
                    const stored = localStorage.getItem('trophyConfig');
                    if (stored) {
                        return JSON.parse(stored);
                    }
                } catch (error) {
                    console.warn('æ— æ³•åŠ è½½æœ¬åœ°é…ç½®:', error);
                }
                return null;
            }
        }

        // å¥–æ¯æ•°æ®ç®¡ç†ç±»
        class TrophyManager {
            constructor() {
                this.configManager = new ConfigManager();
                this.config = null;
                this.data = {};
                this.availableData = {}; // æ–°å¢ï¼šå­˜å‚¨å¯è·å¾—æ•°é‡
                
                this.elements = {
                    totalEarned: document.getElementById('total-earned'),
                    totalAvailable: document.getElementById('total-available'),
                    progressPercentage: document.getElementById('progress-percentage'),
                    progressCircle: document.getElementById('progress-circle'),
                    platinum: document.querySelector('[data-trophy="platinum"]'),
                    gold: document.querySelector('[data-trophy="gold"]'),
                    silver: document.querySelector('[data-trophy="silver"]'),
                    bronze: document.querySelector('[data-trophy="bronze"]')
                };
                
                this.modalElements = {
                    overlay: document.getElementById('trophy-modal'),
                    closeBtn: document.getElementById('modal-close'),
                    cancelBtn: document.getElementById('modal-cancel'),
                    resetBtn: document.getElementById('modal-reset'),
                    saveBtn: document.getElementById('modal-save'),
                    // å·²è·å¾—è¾“å…¥æ¡†
                    platinumEarned: document.getElementById('platinum-earned'),
                    goldEarned: document.getElementById('gold-earned'),
                    silverEarned: document.getElementById('silver-earned'),
                    bronzeEarned: document.getElementById('bronze-earned'),
                    // å¯è·å¾—è¾“å…¥æ¡†
                    platinumAvailable: document.getElementById('platinum-available'),
                    goldAvailable: document.getElementById('gold-available'),
                    silverAvailable: document.getElementById('silver-available'),
                    bronzeAvailable: document.getElementById('bronze-available'),
                    // ç»Ÿè®¡æ˜¾ç¤º
                    modalTotalEarned: document.getElementById('modal-total-earned'),
                    modalTotalAvailable: document.getElementById('modal-total-available'),
                    modalCompletion: document.getElementById('modal-completion'),
                    modalRemaining: document.getElementById('modal-remaining')
                };
                
                this.init();
            }

            // åˆå§‹åŒ–
            async init() {
                await this.loadConfig();
                this.setupEventListeners();
                this.setupModalEventListeners();
                this.applyTheme();
                this.updateUI();
                this.addProgressAnimation();
            }

            // åŠ è½½é…ç½®
            async loadConfig() {
                // ä¼˜å…ˆä»localStorageåŠ è½½
                let localConfig = this.configManager.loadLocalConfig();
                if (localConfig) {
                    this.config = localConfig;
                    this.data = this.config.trophyData;
                    // åˆå§‹åŒ–å¯è·å¾—æ•°é‡æ•°æ®
                    this.availableData = this.config.availableData || {
                        platinum: 1,
                        gold: 5,
                        silver: 20,
                        bronze: 37
                    };
                } else {
                    // å¦‚æœæ²¡æœ‰æœ¬åœ°é…ç½®ï¼Œå°è¯•åŠ è½½æ–‡ä»¶é…ç½®
                    this.config = await this.configManager.loadConfig();
                    this.data = this.config.trophyData;
                    // åˆå§‹åŒ–å¯è·å¾—æ•°é‡æ•°æ®
                    this.availableData = {
                        platinum: 1,
                        gold: 5,
                        silver: 20,
                        bronze: 37
                    };
                }
            }

            // ä¿å­˜é…ç½®
            saveConfig() {
                if (this.config && this.config.settings.autoSave) {
                    this.config.trophyData = { ...this.data };
                    this.config.availableData = { ...this.availableData };
                    // é‡æ–°è®¡ç®—æ€»å¯è·å¾—æ•°é‡
                    this.config.trophyData.totalAvailable = this.getTotalAvailable();
                    this.configManager.saveConfig(this.config);
                }
            }

            // åº”ç”¨ä¸»é¢˜
            applyTheme() {
                const theme = this.config.settings.theme || 'dark';
                document.documentElement.setAttribute('data-theme', theme);
            }

            // åˆ‡æ¢ä¸»é¢˜
            toggleTheme() {
                const currentTheme = this.config.settings.theme || 'dark';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                this.config.settings.theme = newTheme;
                this.applyTheme();
                this.saveConfig();
            }

            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners() {
                const trophyTypes = ['platinum', 'gold', 'silver', 'bronze'];
                
                trophyTypes.forEach(type => {
                    const element = this.elements[type].parentElement;
                    
                    // ä½¿ç”¨å³é”®å‡å°‘ï¼Œå·¦é”®å¢åŠ çš„æ–¹å¼
                    element.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.modifyTrophy(type, 1);
                    });
                    
                    element.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        this.modifyTrophy(type, -1);
                    });
                });
            }

            // è®¾ç½®æ‚¬æµ®çª—äº‹ä»¶ç›‘å¬å™¨
            setupModalEventListeners() {
                // æ‰“å¼€æ‚¬æµ®çª—
                document.addEventListener('keydown', (e) => {
                    if (e.key.toLowerCase() === 'f' && !e.ctrlKey && !e.metaKey && !e.altKey) {
                        e.preventDefault();
                        this.openModal();
                    }
                    if (e.key === 'Escape') {
                        this.closeModal();
                    }
                });

                // å…³é—­æŒ‰é’®
                this.modalElements.closeBtn.addEventListener('click', () => this.closeModal());
                this.modalElements.cancelBtn.addEventListener('click', () => this.closeModal());

                // ç‚¹å‡»èƒŒæ™¯å…³é—­
                this.modalElements.overlay.addEventListener('click', (e) => {
                    if (e.target === this.modalElements.overlay) {
                        this.closeModal();
                    }
                });

                // ä¿å­˜æŒ‰é’®
                this.modalElements.saveBtn.addEventListener('click', () => this.saveModalData());

                // é‡ç½®æŒ‰é’®
                this.modalElements.resetBtn.addEventListener('click', () => this.resetModalData());

                // è¾“å…¥æ¡†å®æ—¶æ›´æ–°
                const inputElements = [
                    'platinumEarned', 'goldEarned', 'silverEarned', 'bronzeEarned',
                    'platinumAvailable', 'goldAvailable', 'silverAvailable', 'bronzeAvailable'
                ];

                inputElements.forEach(elementName => {
                    this.modalElements[elementName].addEventListener('input', () => {
                        this.updateModalSummary();
                    });
                });
            }

            // ä¿®æ”¹å¥–æ¯æ•°é‡
            modifyTrophy(type, delta) {
                const newValue = Math.max(0, this.data[type] + delta);
                
                if (newValue !== this.data[type]) {
                    this.data[type] = newValue;
                    this.updateUI();
                    this.saveConfig();
                    this.addClickFeedback(type);
                    this.addNumberChangeAnimation(type);
                }
            }

            // æ·»åŠ ç‚¹å‡»åé¦ˆåŠ¨ç”»
            addClickFeedback(type) {
                const element = this.elements[type].parentElement;
                element.classList.add('clicked');
                setTimeout(() => {
                    element.classList.remove('clicked');
                }, 200);
            }

            // æ·»åŠ æ•°å­—å˜åŒ–åŠ¨ç”»
            addNumberChangeAnimation(type) {
                const countElement = this.elements[type];
                countElement.classList.add('changed');
                setTimeout(() => {
                    countElement.classList.remove('changed');
                }, 300);
            }

            // PlayStation å®˜æ–¹å¥–æ¯è®¡åˆ†è§„åˆ™
            getTrophyScores() {
                return {
                    bronze: 15,
                    silver: 30,
                    gold: 90,
                    platinum: 300
                };
            }

            // è®¡ç®—å·²è·å¾—å¥–æ¯æ€»æ•°
            getTotalEarned() {
                return Object.keys(this.data)
                    .filter(key => key !== 'totalAvailable')
                    .reduce((total, key) => total + this.data[key], 0);
            }

            // è®¡ç®—å¯è·å¾—å¥–æ¯æ€»æ•°
            getTotalAvailable() {
                return Object.values(this.availableData).reduce((total, value) => total + value, 0);
            }

            // è®¡ç®—å·²è·å¾—å¥–æ¯åˆ†æ•°ï¼ˆåŠ æƒè®¡åˆ†ï¼‰
            getEarnedScore() {
                const scores = this.getTrophyScores();
                return (this.data.bronze * scores.bronze) +
                       (this.data.silver * scores.silver) +
                       (this.data.gold * scores.gold) +
                       (this.data.platinum * scores.platinum);
            }

            // è®¡ç®—æ€»å¯è·å¾—åˆ†æ•°ï¼ˆåŠ æƒè®¡åˆ†ï¼‰
            getTotalScore() {
                const scores = this.getTrophyScores();
                return (this.availableData.bronze * scores.bronze) +
                       (this.availableData.silver * scores.silver) +
                       (this.availableData.gold * scores.gold) +
                       (this.availableData.platinum * scores.platinum);
            }

            // è®¡ç®—è¿›åº¦ç™¾åˆ†æ¯”ï¼ˆåŸºäºåŠ æƒåˆ†æ•°ï¼‰
            getProgressPercentage() {
                const earnedScore = this.getEarnedScore();
                const totalScore = this.getTotalScore();
                if (totalScore === 0) return 0;
                return Math.round((earnedScore / totalScore) * 100);
            }

            // æ›´æ–°UIæ˜¾ç¤º
            updateUI() {
                // æ›´æ–°å„é¡¹æ•°æ®
                this.elements.totalAvailable.textContent = this.getTotalAvailable();
                this.elements.totalEarned.textContent = this.getTotalEarned();
                this.elements.platinum.textContent = this.data.platinum;
                this.elements.gold.textContent = this.data.gold;
                this.elements.silver.textContent = this.data.silver;
                this.elements.bronze.textContent = this.data.bronze;
                
                this.updateProgress();
            }

            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            updateProgress() {
                const percentage = this.getProgressPercentage();
                this.elements.progressPercentage.textContent = percentage + '%';
                
                // ä½¿ç”¨CSSå˜é‡æ›´æ–°è¿›åº¦åœ†ç¯
                document.documentElement.style.setProperty('--progress', percentage + '%');
            }

            // æ·»åŠ è¿›åº¦åŠ¨ç”»
            addProgressAnimation() {
                this.elements.progressCircle.classList.add('animated');
            }

            // æ‰“å¼€æ‚¬æµ®çª—
            openModal() {
                this.loadDataToModal();
                this.modalElements.overlay.classList.add('show');
                // èšç„¦åˆ°ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†
                setTimeout(() => {
                    this.modalElements.platinumEarned.focus();
                }, 300);
            }

            // å…³é—­æ‚¬æµ®çª—
            closeModal() {
                this.modalElements.overlay.classList.remove('show');
            }

            // å°†å½“å‰æ•°æ®åŠ è½½åˆ°æ‚¬æµ®çª—
            loadDataToModal() {
                // åŠ è½½å·²è·å¾—æ•°æ®
                this.modalElements.platinumEarned.value = this.data.platinum || 0;
                this.modalElements.goldEarned.value = this.data.gold || 0;
                this.modalElements.silverEarned.value = this.data.silver || 0;
                this.modalElements.bronzeEarned.value = this.data.bronze || 0;

                // åŠ è½½å¯è·å¾—æ•°æ®
                this.modalElements.platinumAvailable.value = this.availableData.platinum || 1;
                this.modalElements.goldAvailable.value = this.availableData.gold || 5;
                this.modalElements.silverAvailable.value = this.availableData.silver || 20;
                this.modalElements.bronzeAvailable.value = this.availableData.bronze || 37;

                this.updateModalSummary();
            }

            // æ›´æ–°æ‚¬æµ®çª—ç»Ÿè®¡æ‘˜è¦
            updateModalSummary() {
                const earnedValues = {
                    platinum: parseInt(this.modalElements.platinumEarned.value) || 0,
                    gold: parseInt(this.modalElements.goldEarned.value) || 0,
                    silver: parseInt(this.modalElements.silverEarned.value) || 0,
                    bronze: parseInt(this.modalElements.bronzeEarned.value) || 0
                };

                const availableValues = {
                    platinum: parseInt(this.modalElements.platinumAvailable.value) || 0,
                    gold: parseInt(this.modalElements.goldAvailable.value) || 0,
                    silver: parseInt(this.modalElements.silverAvailable.value) || 0,
                    bronze: parseInt(this.modalElements.bronzeAvailable.value) || 0
                };

                const totalEarned = Object.values(earnedValues).reduce((sum, val) => sum + val, 0);
                const totalAvailable = Object.values(availableValues).reduce((sum, val) => sum + val, 0);
                
                // ä½¿ç”¨åŠ æƒè®¡åˆ†åˆ¶è®¡ç®—è¿›åº¦
                const scores = this.getTrophyScores();
                const earnedScore = (earnedValues.bronze * scores.bronze) +
                                   (earnedValues.silver * scores.silver) +
                                   (earnedValues.gold * scores.gold) +
                                   (earnedValues.platinum * scores.platinum);
                
                const totalScore = (availableValues.bronze * scores.bronze) +
                                  (availableValues.silver * scores.silver) +
                                  (availableValues.gold * scores.gold) +
                                  (availableValues.platinum * scores.platinum);
                
                const completion = totalScore > 0 ? Math.round((earnedScore / totalScore) * 100) : 0;
                const remaining = totalAvailable - totalEarned;

                this.modalElements.modalTotalEarned.textContent = totalEarned;
                this.modalElements.modalTotalAvailable.textContent = totalAvailable;
                this.modalElements.modalCompletion.textContent = completion + '%';
                this.modalElements.modalRemaining.textContent = remaining;

                // æ›´æ–°åˆ†æ•°è¯¦æƒ…æ˜¾ç¤º
                this.updateScoreDetails(earnedValues, availableValues, earnedScore, totalScore);

                // éªŒè¯æ•°æ®åˆç†æ€§
                Object.keys(earnedValues).forEach(type => {
                    const earnedInput = this.modalElements[type + 'Earned'];
                    const availableInput = this.modalElements[type + 'Available'];
                    
                    if (earnedValues[type] > availableValues[type]) {
                        earnedInput.style.borderColor = '#f44336';
                        earnedInput.title = 'å·²è·å¾—æ•°é‡ä¸èƒ½è¶…è¿‡å¯è·å¾—æ•°é‡';
                    } else {
                        earnedInput.style.borderColor = '';
                        earnedInput.title = '';
                    }
                });
            }

            // æ›´æ–°åˆ†æ•°è¯¦æƒ…æ˜¾ç¤º
            updateScoreDetails(earnedValues, availableValues, earnedScore, totalScore) {
                const scores = this.getTrophyScores();
                
                // æ›´æ–°å„å¥–æ¯åˆ†æ•°å…¬å¼
                document.getElementById('platinum-score-formula').textContent = 
                    `${earnedValues.platinum} Ã— ${scores.platinum}åˆ† = ${earnedValues.platinum * scores.platinum}åˆ†`;
                
                document.getElementById('gold-score-formula').textContent = 
                    `${earnedValues.gold} Ã— ${scores.gold}åˆ† = ${earnedValues.gold * scores.gold}åˆ†`;
                
                document.getElementById('silver-score-formula').textContent = 
                    `${earnedValues.silver} Ã— ${scores.silver}åˆ† = ${earnedValues.silver * scores.silver}åˆ†`;
                
                document.getElementById('bronze-score-formula').textContent = 
                    `${earnedValues.bronze} Ã— ${scores.bronze}åˆ† = ${earnedValues.bronze * scores.bronze}åˆ†`;
                
                // æ›´æ–°æ€»åˆ†æ•°æ˜¾ç¤º
                document.getElementById('total-score-display').textContent = 
                    `${earnedScore} / ${totalScore}åˆ†`;
            }

            // ä¿å­˜æ‚¬æµ®çª—æ•°æ®
            saveModalData() {
                const earnedValues = {
                    platinum: parseInt(this.modalElements.platinumEarned.value) || 0,
                    gold: parseInt(this.modalElements.goldEarned.value) || 0,
                    silver: parseInt(this.modalElements.silverEarned.value) || 0,
                    bronze: parseInt(this.modalElements.bronzeEarned.value) || 0
                };

                const availableValues = {
                    platinum: parseInt(this.modalElements.platinumAvailable.value) || 0,
                    gold: parseInt(this.modalElements.goldAvailable.value) || 0,
                    silver: parseInt(this.modalElements.silverAvailable.value) || 0,
                    bronze: parseInt(this.modalElements.bronzeAvailable.value) || 0
                };

                // éªŒè¯æ•°æ®
                let hasError = false;
                Object.keys(earnedValues).forEach(type => {
                    if (earnedValues[type] > availableValues[type]) {
                        hasError = true;
                        alert(`${type}å¥–æ¯çš„å·²è·å¾—æ•°é‡ä¸èƒ½è¶…è¿‡å¯è·å¾—æ•°é‡ï¼`);
                        return;
                    }
                });

                if (hasError) return;

                // æ›´æ–°æ•°æ®
                this.data = earnedValues;
                this.availableData = availableValues;

                // æ›´æ–°UIå¹¶ä¿å­˜
                this.updateUI();
                this.saveConfig();
                this.closeModal();

                // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
                this.showNotification('æ•°æ®ä¿å­˜æˆåŠŸï¼');
            }

            // é‡ç½®æ‚¬æµ®çª—æ•°æ®
            resetModalData() {
                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰å¥–æ¯æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                    // é‡ç½®ä¸ºé»˜è®¤å€¼
                    this.modalElements.platinumEarned.value = 0;
                    this.modalElements.goldEarned.value = 0;
                    this.modalElements.silverEarned.value = 0;
                    this.modalElements.bronzeEarned.value = 0;

                    this.modalElements.platinumAvailable.value = 1;
                    this.modalElements.goldAvailable.value = 5;
                    this.modalElements.silverAvailable.value = 20;
                    this.modalElements.bronzeAvailable.value = 37;

                    this.updateModalSummary();
                }
            }

            // æ˜¾ç¤ºé€šçŸ¥
            showNotification(message, duration = 3000) {
                // åˆ›å»ºé€šçŸ¥å…ƒç´ 
                const notification = document.createElement('div');
                notification.textContent = message;
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--accent-color);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                    z-index: 2000;
                    font-size: 14px;
                    font-weight: 500;
                    opacity: 0;
                    transform: translateX(100%);
                    transition: all 0.3s ease;
                `;

                document.body.appendChild(notification);

                // æ˜¾ç¤ºåŠ¨ç”»
                setTimeout(() => {
                    notification.style.opacity = '1';
                    notification.style.transform = 'translateX(0)';
                }, 100);

                // è‡ªåŠ¨ç§»é™¤
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, duration);
            }

            // æ›´æ–°å¥–æ¯æ•°æ®ï¼ˆç”¨äºåŠ¨æ€æ›´æ–°ï¼‰
            updateTrophy(type, count) {
                if (this.data.hasOwnProperty(type)) {
                    this.data[type] = Math.max(0, count);
                    this.updateUI();
                    this.saveConfig();
                }
            }

            // æ‰¹é‡æ›´æ–°å¥–æ¯æ•°æ®
            updateTrophies(newData) {
                Object.assign(this.data, newData);
                this.updateUI();
                this.saveConfig();
            }

            // é‡ç½®æ‰€æœ‰å¥–æ¯æ•°æ®
            resetTrophies() {
                const confirmed = confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰å¥–æ¯æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚');
                if (confirmed) {
                    this.data = {
                        totalAvailable: this.data.totalAvailable,
                        platinum: 0,
                        gold: 0,
                        silver: 0,
                        bronze: 0
                    };
                    this.updateUI();
                    this.saveConfig();
                }
            }

            // å¯¼å‡ºé…ç½®
            exportConfig() {
                const dataStr = JSON.stringify(this.config, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'trophy-config.json';
                link.click();
                URL.revokeObjectURL(url);
            }

            // è·å–å¥–æ¯æ•°æ®
            getData() {
                return { ...this.data };
            }

            // è·å–å®Œæ•´é…ç½®
            getConfig() {
                return { ...this.config };
            }
        }

        // å·¥å…·å‡½æ•°
        const Utils = {
            // é˜²æŠ–å‡½æ•°
            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },

            // æ•°å­—åŠ¨ç”»
            animateNumber(element, start, end, duration = 800) {
                const range = end - start;
                const increment = range / (duration / 16);
                let current = start;
                
                const timer = setInterval(() => {
                    current += increment;
                    if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                        current = end;
                        clearInterval(timer);
                    }
                    element.textContent = Math.round(current);
                }, 16);
            },

            // æ ¼å¼åŒ–æ—¥æœŸ
            formatDate(date) {
                return new Date(date).toLocaleDateString('zh-CN');
            }
        };

        // åˆå§‹åŒ–åº”ç”¨
        let trophyManager;
        
        document.addEventListener('DOMContentLoaded', () => {
            trophyManager = new TrophyManager();
        });

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            // Fé”®æ‰“å¼€æ‚¬æµ®çª—ï¼ˆå·²åœ¨TrophyManagerä¸­å¤„ç†ï¼‰
            
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 's':
                        e.preventDefault();
                        if (trophyManager) {
                            trophyManager.saveConfig();
                            trophyManager.showNotification('é…ç½®å·²ä¿å­˜');
                        }
                        break;
                    case 'r':
                        e.preventDefault();
                        if (trophyManager) {
                            trophyManager.resetTrophies();
                        }
                        break;
                    case 'e':
                        e.preventDefault();
                        if (trophyManager) {
                            trophyManager.exportConfig();
                        }
                        break;
                    case 't':
                        e.preventDefault();
                        if (trophyManager) {
                            trophyManager.toggleTheme();
                            trophyManager.showNotification('ä¸»é¢˜å·²åˆ‡æ¢');
                        }
                        break;
                }
            }
        });

        // å¯¼å‡ºåˆ°å…¨å±€ä½œç”¨åŸŸï¼Œæ–¹ä¾¿è°ƒè¯•å’Œå¤–éƒ¨è°ƒç”¨
        window.TrophyApp = {
            manager: () => trophyManager,
            updateTrophy: (type, count) => trophyManager?.updateTrophy(type, count),
            updateTrophies: (data) => trophyManager?.updateTrophies(data),
            resetTrophies: () => trophyManager?.resetTrophies(),
            exportConfig: () => trophyManager?.exportConfig(),
            getData: () => trophyManager?.getData(),
            getConfig: () => trophyManager?.getConfig(),
            toggleTheme: () => trophyManager?.toggleTheme(),
            setTheme: (theme) => {
                if (trophyManager && ['dark', 'light'].includes(theme)) {
                    trophyManager.config.settings.theme = theme;
                    trophyManager.applyTheme();
                    trophyManager.saveConfig();
                }
            },
            // æ–°å¢æ‚¬æµ®çª—ç›¸å…³æ–¹æ³•
            openModal: () => trophyManager?.openModal(),
            closeModal: () => trophyManager?.closeModal(),
            setAvailableData: (data) => {
                if (trophyManager) {
                    Object.assign(trophyManager.availableData, data);
                    trophyManager.updateUI();
                    trophyManager.saveConfig();
                }
            },
            getAvailableData: () => trophyManager?.availableData,
            // æ–°å¢åˆ†æ•°ç›¸å…³æ–¹æ³•
            getScores: () => trophyManager?.getTrophyScores(),
            getEarnedScore: () => trophyManager?.getEarnedScore(),
            getTotalScore: () => trophyManager?.getTotalScore(),
            getScoreBreakdown: () => {
                if (!trophyManager) return null;
                const scores = trophyManager.getTrophyScores();
                const data = trophyManager.data;
                const available = trophyManager.availableData;
                
                return {
                    earned: {
                        platinum: data.platinum * scores.platinum,
                        gold: data.gold * scores.gold,
                        silver: data.silver * scores.silver,
                        bronze: data.bronze * scores.bronze,
                        total: trophyManager.getEarnedScore()
                    },
                    available: {
                        platinum: available.platinum * scores.platinum,
                        gold: available.gold * scores.gold,
                        silver: available.silver * scores.silver,
                        bronze: available.bronze * scores.bronze,
                        total: trophyManager.getTotalScore()
                    },
                    percentage: trophyManager.getProgressPercentage()
                };
            }
        };

        // é¡µé¢å¸è½½æ—¶ä¿å­˜æ•°æ®
        window.addEventListener('beforeunload', () => {
            if (trophyManager) {
                trophyManager.saveConfig();
            }
        });
    </script>

</body>

</html>